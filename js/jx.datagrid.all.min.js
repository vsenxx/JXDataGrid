///<jscompress sourcefile="jx.Class.js" />
var jx=jx||{};jx.Class=function(){};(function(){var a=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;jx.Class.extend=function(b){function c(){!initializing&&this.init&&this.init.apply(this,arguments)}var f=this.prototype;initializing=!0;var e=new this;initializing=!1;for(var d in b)e[d]="function"==typeof b[d]&&"function"==typeof f[d]&&a.test(b[d])?function(a,b){return function(){var c=this._super;this._super=f[a];var d=b.apply(this,arguments);this._super=c;return d}}(d,b[d]):b[d];c.prototype=e;c.prototype.constructor=c;c.extend=arguments.callee;return c};jx.Base=jx.Class.extend({isEmpty:function(a){if("undefined"!=a&&void 0!=a&&null!=a){if("string"==$.type(a))return!(a&&""!=a&&void 0!=a&&null!=a&&0<a.length);if("array"==$.type(a))return!(a&&void 0!=a&&null!=a&&0<a.length);if("object"==$.type(a))return $.isEmptyObject(a);if("function"==$.type(a))return!1}return!0}})})();jx.DataGrid_Item=jx.Base.extend({_parent:null,_itemData:null,_selfElement:null,init:function(a){this._itemData=a.data||null;this._selfElement=$("\x3cdiv class\x3d'btn-group'\x3e\x3c/div\x3e")},render:function(a){this.clear();if(this.isEmpty(this._itemData.element)){var b=$("\x3cbutton class\x3d'btn '\x3e\x3c/button\x3e").text(this._itemData.title);this.isEmpty(this._itemData.classname)?b.addClass("btn-default"):b.addClass(this._itemData.classname);this._selfElement.append(b)}else this._selfElement.append(this._itemData.element);if(this.isEmpty(a))return this._selfElement;$(a).append(this._selfElement)},clear:function(){this._selfElement.empty()},jump:function(){var a=this._itemData.url;0>a.indexOf("?")&&(a+="?");a+=$.param(this._itemData.params||{});"_blank"==this._itemData.target?window.open(a):window.location.href=a},sendData:function(){var a=this;$.ajax({type:a._itemData.ajax.method||"post",url:a._itemData.url,dataType:"json",data:a._itemData.params||{},xhrFields:{withCredentials:!0},success:function(b){a._itemData.ajax.callback&&a._itemData.ajax.callback.apply(a._selfElement.find("\x3ebutton")[0],[b])}})},renderAfter:function(){this.bindEvent()},bindEvent:function(){var a=this;if(this.isEmpty(this._itemData.element))if(this.isEmpty(this._itemData.callback))this._selfElement.find("\x3ebutton").eq(0).on("click",function(){if(a.isEmpty(a._itemData.url))return!1;a.isEmpty(a._itemData.message)?a.isEmpty(a._itemData.ajax)?a.jump():a.sendData():confirm(a._itemData.message)&&(a.isEmpty(a._itemData.ajax)?a.jump():a.sendData());return!1});else this._selfElement.find("\x3ebutton").eq(0).on("click",this._itemData.callback)}});jx.DataGrid_Toolbar=jx.Base.extend({_parent:null,_selfElement:null,_toolBarItemsDatas:null,_toolItems:null,init:function(a){this._parent=a.parent||null;this._toolBarItemsDatas=a.ItemsDatas||null;this._selfElement=$("\x3cdiv class\x3d'jx-DataGrid-tollbar'\x3e\x3cdiv class\x3d'jx-DataGrid-tollbar-station'\x3e\x3c/div\x3e\x3c/div\x3e");this.initItem()},initItem:function(){if(!this.isEmpty(this._toolBarItemsDatas)){this._toolItems=[];for(var a in this._toolBarItemsDatas){var b=new jx.DataGrid_Item({data:this._toolBarItemsDatas[a]});this._toolItems.push(b)}}},render:function(a){this.clear();for(var b in this._toolItems)this._selfElement.find(".jx-DataGrid-tollbar-station").append(this._toolItems[b].render());if(this.isEmpty(a))return this._selfElement;$(a).append(this._selfElement)},clear:function(){this._selfElement.find(".jx-DataGrid-tollbar-station").empty()},renderAfter:function(){for(var a in this._toolItems)this._selfElement.find(".jx-DataGrid-tollbar-station").append(this._toolItems[a].renderAfter())}});jx.DataGrid=jx.Base.extend({_title:"",_selfElement:null,_element:null,_toolBar:null,init:function(a){this._element={};this._title=a.title||"";this._element.parent=a.parent||null;this._selfElement=$('\x3cdiv class\x3d"panel panel-default jx-DataGrid-box"\x3e\x3cdiv class\x3d"panel-heading"\x3e\x3c/div\x3e\x3cdiv class\x3d"panel-body"\x3e\x3c/div\x3e\x3c/div\x3e');this._toolBar=new jx.DataGrid_Toolbar({parent:this,ItemsDatas:a.toolBar});this._table=new jx.DataGrid_Table(a);this.render()},render:function(){this.clear();this._selfElement.find("\x3e.panel-heading").text(this._title);this._selfElement.find("\x3e.panel-body").eq(0).append(this._toolBar.render());this._selfElement.find("\x3e.panel-body").eq(0).append(this._table.render());this._element.parent.append(this._selfElement);this.renderAfter()},search:function(){this._table.search()},clear:function(){this._selfElement.find("\x3e.panel-heading").empty();this._selfElement.find("\x3e.panel-body").empty()},renderAfter:function(){this._toolBar.renderAfter();this._table.renderAfter()}});jx.DataGrid_Filter=jx.Base.extend({_filterData:null,_key:null,_selfElement:null,init:function(a){this._filterData=a.data||null;this._key=a.key||null;if(this.isEmpty(this._filterData))return this;if("string"==$.type(this._filterData))"text"==this._filterData&&(this._selfElement=$('\x3cinput class\x3d"form-control" \x3e').attr("name",this._key));else if(this._filterData instanceof jQuery)this._selfElement=this._filterData;else if(this._filterData instanceof HTMLElement)this._selfElement=this._filterData;else if("object"==$.type(this._filterData)&&$.isPlainObject(this._filterData))if("select"==this._filterData.filtername){this._selfElement=$('\x3cselect class\x3d"form-control" \x3e').attr("name",this._key);for(var b in this._filterData.options)this._selfElement.append($("\x3coption\x3e\x3c/option\x3e").text(this._filterData.options[b].text).val(this._filterData.options[b].value))}else if("daterangepicker"==this._filterData.filtername||"datepicker"==this._filterData.filtername){this._selfElement=$('\x3cinput class\x3d"form-control" \x3e').attr("name",this._key);if(!$.fn.daterangepicker)return this;a={opens:"left",format:"YYYY-MM-DD",singleDatePicker:"datepicker"==this._filterData.filtername?!0:!1,locale:{applyLabel:"\u786e\u5b9a",cancelLabel:"\u53d6\u6d88",fromLabel:"\u8d77\u59cb\u65f6\u95f4",toLabel:"\u7ed3\u675f\u65f6\u95f4'",weekLabel:"W",daysOfWeek:"\u65e5\u4e00\u4e8c\u4e09\u56db\u4e94\u516d".split(""),monthNames:"\u4e00\u6708 \u4e8c\u6708 \u4e09\u6708 \u56db\u6708 \u4e94\u6708 \u516d\u6708 \u4e03\u6708 \u516b\u6708 \u4e5d\u6708 \u5341\u6708 \u5341\u4e00\u6708 \u5341\u4e8c\u6708".split(" "),firstDay:1}};$(this._selfElement).daterangepicker(a)}else"searchselect"==this._filterData.filtername&&(this._selfElement=$('\x3cselect class\x3d"form-control" style\x3d"width:100%;"\x3e\x3c/select\x3e').attr("name",this._key))},render:function(a){this.clear();if(this.isEmpty(a))return this._selfElement;$(a).append(this._selfElement)},renderAfter:function(){if(!this.isEmpty(this._filterData.filtername)&&"searchselect"==this._filterData.filtername){if(!$.fn.select2)return this;this._selfElement.select2({ajax:{url:this._filterData.url,type:this._filterData.method||"post",cache:!0,dataType:"json",delay:200}})}},clear:function(){}});jx.DataGrid_Table=jx.Base.extend({_thead:null,_tbody:null,_custompanel:null,_actions:null,_url:null,_params:null,_method:null,init:function(a){this._url=a.url||null;this._params=a.params||null;this._method=a.method||null;this._selfElement=$('\x3ctable class\x3d"table table-bordered table-hover"\x3e\x3c/table\x3e');this._custompanel=a.custompanel||null;this._actions=a.actions||null;this.initThead(a);this.initTbody(a)},initThead:function(a){this._thead={Element:$("\x3cthead\x3e\x3ctr\x3e\x3c/tr\x3e\x3c/thead\x3e"),datas:a.thead||null,theads:[]};if(this.isEmpty(this._thead.datas))return!1;this._thead.theads.push({element:$('\x3ctd style\x3d"width:2%"\x3e#\x3c/td\x3e')});this.isEmpty(this._custompanel)||"function"!=$.type(this._custompanel)||this._thead.theads.push({element:$('\x3ctd style\x3d"width:2%"\x3e\x3ci class\x3d"glyphicon glyphicon-triangle-right custompanel-launcher"\x3e\x3c/i\x3e\x3c/td\x3e')});for(var b in this._thead.datas){var c=this._thead.datas[b];a=$('\x3ctd\x3e\x3cdiv class\x3d"form-group"\x3e\x3clabel for\x3d""\x3e\u6807\u9898\x3c/label\x3e\x3c/div\x3e\x3c/td\x3e');a.attr("key",c.key);!0!==c.primary&&"true"!=c.primary||a.attr("primary",!0);this.isEmpty(c.width)||a.css({width:c.width});a.find("label").text(c.title);c=new jx.DataGrid_Filter({key:c.key,data:c.filter});this._thead.theads.push({element:a,filter:c})}this.isEmpty(this._actions)||this._thead.theads.push({element:$('\x3ctd\x3e\x3cdiv class\x3d"form-group"\x3e\x3clabel for\x3d""\x3e\u64cd\u4f5c\x3c/label\x3e\x3c/div\x3e\x3c/td\x3e')})},initTbody:function(a){this._tbody={Element:$("\x3ctbody\x3e\x3c/tbody\x3e"),datas:a.datas||null}},renderThead:function(){for(var a in this._thead.theads)this._thead.theads[a].filter&&this._thead.theads[a].element.find("\x3e.form-group").eq(0).append(this._thead.theads[a].filter.render()),this._thead.Element.find("tr").eq(0).append(this._thead.theads[a].element)},search:function(){var a=this;this.clearTbody();var b={},c;for(c in this._thead.theads){var f=this._thead.theads[c].element.find("\x3e.form-group\x3einput,\x3e.form-group\x3eselect").eq(0);0>=f.length||this.isEmpty(f.val())||(b[f.attr("name")]=f.val())}console.log(b);$.ajax({type:a._method||"post",url:a._url,dataType:"json",data:a.params||{},xhrFields:{withCredentials:!0},success:function(b){a._tbody.datas=b;setTimeout(function(){a.renderTbody()},100)}})},renderTbody:function(){if(this.isEmpty(this._tbody.datas)&&this.isEmpty(this._thead.datas)||this.isEmpty(this._tbody.datas)&&this.isEmpty(this._url))return!1;if(this.isEmpty(this._tbody.datas))return this.search(),!1;for(var a=0;a<this._tbody.datas.length;a++){var b=this._tbody.datas[a],c=$("\x3ctr\x3e\x3ctd\x3e"+(a+1)+"\x3c/td\x3e\x3c/tr\x3e");this.isEmpty(this._custompanel)||"function"!=$.type(this._custompanel)||c.append($('\x3ctd\x3e\x3ci class\x3d"glyphicon glyphicon-triangle-right custompanel-launcher"\x3e\x3c/i\x3e\x3c/td\x3e'));var f={},e;for(e in this._thead.datas){var d=this._thead.datas[e].key,g=$("\x3ctd\x3e"+b[d]+"\x3c/td\x3e");g.attr("key",d);if(!0===this._thead.datas[e].primary||"true"==this._thead.datas[e].primary)f[d]=b[d],g.attr("primary",!0);c.append(g)}if(!this.isEmpty(this._actions)){d=$("\x3ctd\x3e\x3c/td\x3e");for(e in this._actions)this._actions[e].params=$.extend(!0,this._actions[e].params||{},f),g=new jx.DataGrid_Item({data:this._actions[e]}),d.append(g.render()),g.bindEvent();c.append(d)}this._tbody.Element.append(c);this.isEmpty(this._custompanel)||"function"!=$.type(this._custompanel)||(c=$("\x3ctr style\x3d'display: none;' class\x3d'custompanel'\x3e\x3c/tr\x3e"),c.append(this._custompanel(this._thead.datas,b)),this._tbody.Element.append(c))}this.bindEvent()},render:function(a){this.clear();this.renderThead();this._selfElement.append(this._thead.Element);this.renderTbody();this._selfElement.append(this._tbody.Element);if(this.isEmpty(a))return this._selfElement;$(a).append(this._selfElement)},bindEvent:function(){var a=this;this._tbody.Element.find(".custompanel-launcher").on("click",function(){$(this).hasClass("glyphicon-triangle-right")?(a._tbody.Element.find(".custompanel:visible").hide(),a._tbody.Element.find(".custompanel-launcher").removeClass("glyphicon-triangle-bottom").addClass("glyphicon-triangle-right"),$(this).removeClass("glyphicon-triangle-right").addClass("glyphicon-triangle-bottom"),$(this).closest("tr").next().show(500)):(a._tbody.Element.find(".custompanel:visible").hide(),a._tbody.Element.find(".custompanel-launcher").removeClass("glyphicon-triangle-bottom").addClass("glyphicon-triangle-right"))})},clear:function(){this.clearTbody()},clearTbody:function(){this._tbody.Element.empty()},renderAfter:function(){for(var a in this._thead.theads)this._thead.theads[a].filter&&this._thead.theads[a].filter.renderAfter()}});